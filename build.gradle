/*
 * This file was generated by the Gradle 'init' task.
 */

plugins {
    id 'java'
    id 'maven-publish'
}

repositories {
    mavenLocal()
    maven {
        url = uri('https://repo.maven.apache.org/maven2/')
    }
}

dependencies {
    implementation 'junit:junit:4.12'
    implementation 'org.seleniumhq.selenium:selenium-java:3.141.59'
    implementation 'commons-io:commons-io:2.8.0'
}

group = 'sandipchitale'
version = '1.0-SNAPSHOT'
description = 'selenoid'
java.sourceCompatibility = JavaVersion.VERSION_11

publishing {
    publications {
        maven(MavenPublication) {
            from(components.java)
        }
    }
}

task startSelenoid(type: Exec) {
    group 'selenoid'
    // executable "cm"
    // args "selenoid", "start"
    commandLine 'cmd', '/c', '.\\cm.exe selenoid start'
}

task startSelenoidUI(type: Exec) {
    group 'selenoid'
    dependsOn "startSelenoid"
    // executable "cm"
    // args "selenoid-ui", "start", "-p", "4445"
    commandLine 'cmd', '/c', '.\\cm.exe selenoid-ui start -p 4445'
}

task openSelenoidUI(type:Exec) {
    group 'selenoid'
    dependsOn "startSelenoidUI"
    commandLine 'cmd', '/c', 'start http://localhost:4445'
}

tasks.test.dependsOn("openSelenoidUI")

task stopSelenoid(type: Exec) {
    group 'selenoid'
    // executable "cm"
    // args "selenoid", "stop"
    commandLine 'cmd', '/c', '.\\cm.exe selenoid stop'
}

task stopSelenoidUI(type: Exec) {
    group 'selenoid'
    // executable "cm"
    // args "selenoid-ui", "stop"
    commandLine 'cmd', '/c', '.\\cm.exe selenoid-ui stop'
}

tasks.stopSelenoid.dependsOn("stopSelenoidUI")
tasks.stopSelenoid.shouldRunAfter("stopSelenoidUI")
tasks.test.finalizedBy("stopSelenoid")

test {
    outputs.upToDateWhen { false }
}
